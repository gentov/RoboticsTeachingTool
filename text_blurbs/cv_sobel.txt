Next, the intensity gradient is calculated.  To get the gradient, which is the rate of change of the pixel intensity, the gaussian blurred image is then smoothed by a Sobel kernel in the x and y directions to get the first derivatives in both directions.  From these two images, the edge gradient and direction for each pixel can be calculated as seen on the right.  The gradient direction is always perpendicular to image edges, and is rounded to either the vertical, horizontal, or two diagonal directions.